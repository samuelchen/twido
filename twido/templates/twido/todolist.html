{% extends "base.html" %}{% load customer_tags staticfiles %}

{% block title %}Todo List{% endblock %}

{% block head %}
    <script language="JavaScript" src="{% static 'twido/js/bootstrap-confirmation.min.js' %}"></script>
    {% include 'includes/editable-head-ref.html' %}
    <script language="JavaScript" type="text/javascript">
        $.fn.editable.defaults.mode = 'inline';
        $.fn.editable.defaults.showbuttons = false;
        $.fn.editable.defaults.onblur = 'submit';
    </script>
{% endblock %}

{% block content %}

    <div class="bs-docs-section container-fluid container-responsive">

{#        {% include 'includes/blank-div-row.html' %}#}

        <div class="row">
            <!-- left col -->
            <div class="col-lg-3 col-md-3 col-sm-4">
                <div class="bs-component">
                    {% include 'twido/includes-list/todolists-menu.html' %}
                </div>

                <div class="bs-component">
                    <form id="id_form_action" action="{{ request.path }}" method="post">
                        {% csrf_token %}
                        <input type="hidden" name="action">
                        <div class="btn-group btn-group-justified btn-group-sm">
                            <a name="add" title="Create a new list" class="btn btn-default btn-block"><i class="glyphicon glyphicon-list"></i> Create List</a>
                            {% if not thelist.is_default %}
                            <a name="del" title="Delete current list" data-toggle="confirmation" class="btn btn-default btn-block"><i class="glyphicon glyphicon-remove"></i> Delete List</a>
                            {% endif %}
{#                            <a name="add-todo" title="Add a task to current list" class="btn btn-info btn-block"><i class="glyphicon glyphicon-plus"></i> Create Todo</a>#}
                        </div>
                    </form>
                </div>
            </div>

            <!-- main col -->
            <div class="col-lg-8 col-md-8 col-sm-7">
                <div class="row">

                    <div class="bs-component">

{#                        <h2 id="listname" class="text-center">{{ thelist.name | upper }}</h2>#}
                        <div class="panel">
                            {% include 'includes/message.html' %}
                            {% include 'twido/includes-list/todolist-form.html' %}
                        </div>

                        {% include 'twido/includes-list/todos.html' %}
                        <div class="btn-group btn-group-justified btn-group-sm">
                            <a name="add-todo" title="Add a task to current list" class="btn btn-info btn-block"><i class="glyphicon glyphicon-plus"></i> Create Todo</a>
                        </div>
                    </div>

                </div>
            </div>

        </div>

    </div>

{% endblock %}

{% block script %}


    <script type="text/javascript" language="JavaScript">
        $(".editable").addClass('no_underline').css("cursor", "pointer");


        var form_action = $("#id_form_action");

        $("a.btn").tooltip({container: 'body'}).click(function(e){
            var action = $(this).attr('name');
            form_action.find("input[name='action']").val(action);
            if ($.inArray(action, ['add', 'add-todo']) >= 0) form_action.submit();
            // if action is "del", need to confirm (code below)
        });

        form_action.find('a[name="del"]').confirmation({
            onConfirm: function () {
                form_action.submit();
            },
            html: 'true',
            title: '<span class="text-danger">DANGER : Delete list "{{ thelist.name }}(id:{{ thelist.id }})" ?</span>'
                        +'<p/><p class="small">All tasks in this list will be moved to default list',
            placement: 'bottom'
        });
    </script>
{% endblock %}
