{% extends "base.html" %}{% load customer_tags staticfiles i18n %}

{% block title %}{% trans 'Task Detail' %}{% endblock %}

{% block head %}
{#    <script language="JavaScript" src="{% static 'jqueryui/dragdrop/jquery-ui.min.js' %}"></script>#}
    {% include 'includes/editable-head-ref.html' %}

{% endblock %}

{% block content %}

    <div class="bs-docs-section container-fluid container-responsive">

        <div class="row">
            <!-- left col -->
            <div class="col-lg-3 col-md-3 col-sm-4">

                <div class="panel panel-default" name="{{ thetask.list.name }}">
                    <div class="panel-heading small">
                        <ul class="list-inline">
                            <li><h3 class="panel-title">{% if thetask.list.is_default %}{% trans 'Default List' %}{% else %}{{ thetask.list.name|capfirst }}{% endif %}</h3></li>
                        </ul>
                    </div>
                    <ul class="list-group">
                        {% for task in page %}
                            <a href="{% url 'task' task.id %}?p={{ page.number }}" class="list-group-item small {% if thetask.id == task.id %}active{% endif %}">
                                <ul class="list-inline">
                                    <li><i title={{ task.get_status_text }} class="{{ task.get_status_glyphicon }}"></i></li>
                                    <li>{{ task.title | url2link | safe }}</li>
                                    <li class="top-right">
                                        <span title="Reminder" class="small">
                                            {{ task.reminder |default_if_none:'<i class="glyphicon glyphicon-time"></i>' }}
                                        </span>
                                    </li>
                                </ul>
                            </a>
                        {% endfor %}
                    </ul>
                    <div class="text-center">
                        {% include 'includes/paginatition.html' %}
                    </div>
                </div>

                <div class="bs-component">
                    <form id="id_form_action" action="{{ request.path }}" method="post">
                        {% csrf_token %}
                        <input type="hidden" name="action">
                        <div class="btn-group btn-group-justified btn-group-sm">
                            <a name="add" title="{% trans 'Add a task to current list' %}" class="btn btn-default btn-block"><i class="glyphicon glyphicon-list"></i> {% trans 'Add Task' %}</a>
                            {% if not thelist.is_default %}
                            <a name="del" title="{% trans 'Delete current task' %}" data-toggle="confirmation" class="btn btn-default btn-block"><i class="glyphicon glyphicon-remove"></i> {% trans 'Delete Task' %}</a>
                            {% endif %}
                        </div>
                    </form>
                </div>
            </div>

            <!-- main col -->
            <div class="col-lg-8 col-md-8 col-sm-7">
                <div class="row">
                    {% include 'includes/django-messags-inc.html' %}
                    {% include 'twido/includes-list/task-form.html' %}
                </div>
            </div>

        </div>

    </div>

{% endblock %}

{% block script %}


    <script type="text/javascript" language="JavaScript">
{##}
{#    $(document).ready(function(){#}
{#        var form_action = $("#id_form_action");#}
{##}
{#        $("a.btn").tooltip({container: 'body'}).click(function(e){#}
{#            var action = $(this).attr('name');#}
{#            form_action.find("input[name='action']").val(action);#}
{#            if ($.inArray(action, ['add', 'add-todo']) >= 0) form_action.submit();#}
{#            // if action is "del", need to confirm (code below)#}
{#        });#}
{##}
{#        form_action.find('a[name="del"]').confirmation({#}
{#            onConfirm: function () {#}
{#                form_action.submit();#}
{#            },#}
{#            html: 'true',#}
{#            title: '<span class="text-danger">{% trans 'DANGER : Delete list' %} "{{ thelist.name }}(id:{{ thelist.id }})" ?</span>'#}
{#                        +'<p/><p class="small">{% trans 'All tasks in this list will be moved to default list' %}',#}
{#            placement: 'right'#}
{#        });#}
{##}
        $(".editable").addClass('no_underline').css("cursor", "pointer");
{#    }#}
    </script>
{% endblock %}
